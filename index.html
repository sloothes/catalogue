<!DOCTYPE html>
<html>
<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description" contents="">

    <title>Clothes catalogue (v1.0)</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootbox-dialoges.css">
    <link rel="stylesheet" href="/css/anywhere3d.css">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/photoswipe.css">
    <link rel="stylesheet" href="/css/photoswipe/default-skin.css">

    <script>debugMode = true;</script>
    <script src="/socketcluster.js"></script>
    <script src="/sc-codec-min-bin.js"></script>
    <script src="/js/photoswipe.js"></script>
    <script src="/js/photoswipe-ui-default.js"></script>

</head>

<body>

<style>

    body {
        overflow:auto;
    }

    .well { 
        background:none; 
    }

    .well.product-card { 
    /*  vertical-align:middle !important;  */
        color: #fff;
        display:inline-block; 
        height:48%; 
        width:22.8rem;
    }

    .card-field-price {
        font-size:3rem;
        font-weight:bold;
        font-family:sans-serif;
        text-align:center;
    }

    .card-field-title {
        color:#ccc;
        max-width:100%;
        font-size:2rem;
        font-weight:normal;
        font-family:sans-serif;
        text-overflow:ellipsis;
        text-align:center;
    }

    #catalogue-section {
        overflow:auto;
        background-color:#000;
    }

    #products-display {
        border:none;
        height:700px;
        min-width:320px;
        min-height:438px;
        max-height:705px;
        text-align:center;
        overflow:auto;
    }

    @media all and ( max-width: 640px ) {

        .well.product-card { 
            display:inline-block; 
            height:65%; 
            width:100%;
        }

        #products-display {
            max-height: 300px;
        }
    }

    /*  photoswipe  */

    .viewer {
        width:750px;
        height:750px;
        max-width:90%;
        max-height:90%;
        background:#ffffff33;
    }

</style>

<section class="mbr-section" id="catalogue-section">

    <!-- PAGER -->

<div id="products-catalogue-panel" class="tab-content" style="width:100%;">

    <div id="catalogue-items-panel" class="well" style="width:100%;margin:0;">

        <h4 style="color:#fff;"><a href="/">sloothes</a>/catalogue:
            <div id="counter-top-right" class="pull-right small items-counter" style="margin-top:4px;color:#ddd;">
                <span class="from">zero</span>
                to <span class="upto">zero</span>
                of <span class="count">none</span>
            </div>
        </h4>

        <div id="products-catalogue-pager" class="pager">
            <div style="margin:10px auto 10px auto;height:35px;max-width:350px;">
                <li class="btn btn-primary get-prev-btn pull-left">&#9668;</li>
                <div class="pager-buttons-holder" style="display:inline;">
                    <a class="btn btn-default page-btn">1</a>
                    <a class="btn btn-default page-btn">2</a>
                    <a class="btn btn-default page-btn">3</a>
                    <a class="btn btn-default page-btn">4</a>
                </div>
                <li class="btn btn-primary get-next-btn pull-right">&#9658;</li>
            </div>

            <div id="products-display" class="well"></div>

            <div style="margin:10px auto 10px auto;height:35px;max-width:350px;">
                <li class="btn btn-primary btn-white-outline first-page-btn pull-left" style="margin-right:5px;">First</li>
                <li class="btn btn-primary btn-white-outline get-prev-group-btn pull-left">&#9668;&#9668;</li>
                <div id="counter-bottom-center" class="small items-counter" style="width:fit-content;display:inline;height:35px;margin-top:4px;color:#ddd;">
                    <span class="from">zero</span> to <span class="upto">zero</span> of <span class="count">none</span>
                </div>
                <li class="btn btn-primary btn-white-outline last-page-btn pull-right" style="margin-left:5px;">Last</li>
                <li class="btn btn-primary btn-white-outline get-next-group-btn pull-right">&#9658;&#9658;</li>
            </div>
        </div>

    </div>

</div>

    <!-- PHOTOSWIPE -->

<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>

</section>

<script src="/js/store2.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery-ui.js"></script>
<script src="/js/rawinflate.js"></script>
<script src="/js/rawdeflate.js"></script>
<script src="/js/Objectid.js"></script>
<script src="/js/zangodb.min.js"></script>
<script src="/js/bootbox.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/DeviceDetector.js"></script>
<script src="/js/MathDecimalAdjustment.js"></script>
<script src="/js/watermark.js"></script>
<script src="/js/validator.js"></script>
<script src="/js/system.min.js"></script>
<script src="/js/signals.min.js"></script>
<script src="/js/validator.min.js"></script>

<script>

//  Socketcluster.

    var socket = socketCluster.create({
        hostname: "anywhere3d.com",
        codecEngine: scCodecMinBin,
    });

    socket.on("connect", function(status){
        debugMode && console.log({"status": status});
    });

    socket.on("error", function (err) {
        console.error( err.stack );
    });

    socket.on("authStateChange", function( state ){
        debugMode && console.log({"authStateChange": state});
    });

    socket.on("subscribe", function( name, object ){
        debugMode && console.log(`subscribed successfully to "${name}" channel:`, object);
    });

</script>

<script>

socket.on("connect", function(status){

//  Pager.

    const pager = document.getElementById("product-catalogue-pager");
    const displayObjects = document.getElementById("products-display");
    const catalogItemsPanel = document.getElementById("catalogue-items-panel");
    const productCatalogPanel = document.getElementById("product-catalogue-panel");
    const productCatalogPager = document.getElementById("product-catalogue-pager");

    var pagebuttons = $(pager).find(".page-btn");
    var pageslength = $(pager).find(".page-btn").length;

    const firstPageBtn = $(pager).find(".first-page-btn").get(0);
    const lastPageBtn  = $(pager).find(".last-page-btn").get(0);
    const prevPageBtn  = $(pager).find(".get-prev-btn").get(0);
    const nextPageBtn  = $(pager).find(".get-next-btn").get(0);
    const prevGroupBtn = $(pager).find(".get-prev-group-btn").get(0);
    const nextGroupBtn = $(pager).find(".get-next-group-btn").get(0);

    const counterSelector = ".items-counter";
    const pageSelector = "#product-catalogue-pager .page-btn";

    const counters  = $(".items-counter").toArray();
    const counterRT = document.getElementById("counter-top-right");
    const counterBC = document.getElementById("counter-bottom-center");

    var timeout;
    var interval;
    var selectors;
    var delay = 200;

    var limit = 12;
    var currency = "$"; // important!

    var max = 0;
    var skip = 0;
    var lastpage = 0;
    var currentpage = 0;
    var currentindex = 0;

    const collection = "products";

//  Signals.
    var Signal = signals.Signal;

    function count(){
        socket.emit("mongo count", {
            selectors: {},
            collection: collection,
            options: { skip:0 }
        }, function(err, num){
            max = num; 
            $(counterSelector).text(max);
            debugMode && console.log("max:", max);
        });
    }

    function reset(){

        max = 0;
        skip = 0;
        lastpage = 0;
        currentpage = 0;
        currentindex = 0;

    }

    function init(){

    //  Page buttons numbering.
        pagebuttons.each(function(i){
            pagebuttons[i].skip = limit * i;
            $(pagebuttons[i]).text( i + 1 );
        });

    //  Current button setup.
        pagebuttons.removeClass("btn-primary");
        var currentButton = pagebuttons.get(0);
        $(currentButton).addClass("btn-primary");

    //  Clear listed objects.
        $(displayObjects).children().remove();

    }

    function getItems(){

        socket.emit("mongo find", {
            selectors: {},
            collection: collection,
            options: { skip:skip, limit:limit }
        }, function(err, docs){
            debugMode && console.log("docs:", docs);

            if ( !docs.length ) return;
            debugMode && console.log( docs );

        });

    }


    count();
    init();
    getItems();


});

</script>

</body>
</html>
